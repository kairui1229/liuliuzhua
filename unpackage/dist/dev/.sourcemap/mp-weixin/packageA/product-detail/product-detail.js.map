{"version":3,"file":"product-detail.js","sources":["packageA/product-detail/product-detail.vue","../../Hbuilder/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFja2FnZUFccHJvZHVjdC1kZXRhaWxccHJvZHVjdC1kZXRhaWwudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"product-detail\">\n\t\t<swiper class=\"swiper\" circular indicator-dots autoplay :interval=\"3000\" :duration=\"1000\">\n\t\t\t<swiper-item v-for=\"item in productImages\" :key=\"item.id\">\n\t\t\t\t<image :src=\"item.img_url\" mode=\"aspectFill\"></image>\n\t\t\t</swiper-item>\n\t\t</swiper>\r\n\t\t\n\t\t<!--商品信息-->\n\t\t<view class=\"product-info\">\n\t\t\t<view class=\"price-box\">\n\t\t\t\t<text class=\"price\">￥{{productInfo.price}}</text>\n\t\t\t\t<text class=\"original-price\">￥{{productInfo.o_price}}</text>\n\t\t\t</view>\n\t\t\t<view class=\"title\">{{productInfo.name}}</view>\n\t\t\t<view class=\"desc\">{{productInfo.desc}}</view>\n\t\t</view>\r\n\t\t\n\t\t<!--规格选择-->\n\t\t<view class=\"spec-section\" @click=\"showSpecPopup\">\n\t\t\t<text class=\"label\">规格</text>\n\t\t\t<view class=\"selected-spec\">\n\t\t\t\t<text>{{selectedSpec || \"请选择规格\"}}</text>\n\t\t\t\t<up-icon name=\"arrow-right\" size=\"20\" color=\"#999\"></up-icon>\n\t\t\t</view>\n\t\t</view>\r\n\t\t\n\t\t<!--商品详情-->\n\t\t<view class=\"detail-section\">\n\t\t\t<view class=\"section-title\">商品详情</view>\n\t\t\t<view class=\"detail-content\">\n\t\t\t\t<image \n\t\t\t\t\tv-for=\"item in productImages\"\n\t\t\t\t\t:key=\"item.id\"\n\t\t\t\t\tmode=\"widthFix\"\n\t\t\t\t\tclass=\"detail-image\"\n\t\t\t\t\t:src=\"item.img_url\"\n\t\t\t\t></image>\n\t\t\t</view>\n\t\t</view>\r\n\t\t\n\t\t<!--底部操作区域-->\n\t\t<view class=\"bottom-bar\">\n\t\t\t<view class=\"left-btns\">\n\t\t\t\t<view class=\"icon-btn\" @click=\"goHome\">\n\t\t\t\t\t<up-icon name=\"home\" size=\"40\" color=\"#666\"></up-icon>\n\t\t\t\t\t<text>首页</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"icon-btn\" @click=\"goCart\">\n\t\t\t\t\t<up-icon name=\"shopping-cart\" size=\"40\" color=\"#666\"></up-icon>\n\t\t\t\t\t<text>购物车</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t<view class=\"right-btns\">\n\t\t\t\t<view class=\"cart-btn\" @click=\"addCart\">加入购物车</view>\n\t\t\t\t<view class=\"buy-btn\" @click=\"buyNow\">立即购买</view>\n\t\t\t</view>\n\t\t</view>\r\n\t\t\r\n\t\t<ProductSpecPopup :show=\"show\" :product=\"productInfo\" @close=\"handleClose\" :show-ok=\"true\"></ProductSpecPopup>\n\t</view>\n</template>\n\n<script setup lang=\"ts\">\r\nimport {ref,computed} from \"vue\"\r\nimport {onLoad} from \"@dcloudio/uni-app\"\r\nimport { get,post } from \"@/utils/http\";\r\nimport { useSpecStore } from \"@/store/spec\";\r\nimport ProductSpecPopup from \"@/components/products-spec-popup/products-spec-popup.vue\";\r\n\r\nconst specStore = useSpecStore()\r\n\r\ninterface ProductDetail{\n\tid:number;\n\tname:string;\n\tprice:string;\n\tstock:number;\n\tcategory_id:number;\n\tmain_pic:string;\n\tdesc:string;\n\to_price:string;\n}\ninterface ProductImage{\n\tid:number;\n\tproduct_id:number;\n\timg_url:string\n}\r\n\r\nconst productInfo=ref<ProductDetail>({} as ProductDetail)\r\nonLoad((options)=>{\n\tproductInfo.value= JSON.parse(options.product)\r\n\tuni.__f__('log','at packageA/product-detail/product-detail.vue:92',productInfo.value,777)\r\n\tgetImages()\r\n\tspecStore.setSpec(\"\")\r\n\tspecStore.setCount(1)\n})\r\n\r\n//获取轮播图图片\r\nconst productImages=ref<ProductImage[]>([])\r\nconst getImages= async ()=>{\n\ttry {\n\t\tconst res:any=await get(\"/sel/detail\",{id:productInfo.value.id})\n\t\tproductImages.value=res\r\n\t\t//uni.__f__('log','at packageA/product-detail/product-detail.vue:104',productImages.value,555)\n\t} catch (error) {\n\t\tuni.__f__('error','at packageA/product-detail/product-detail.vue:106',\"失败\")\n\t}\n}\r\n\r\n//规格弹窗\r\nconst show = ref(false)\r\nconst showSpecPopup = () =>{\r\n\tshow.value = true\r\n}\r\nconst handleClose = () =>{\r\n\tshow.value = false\r\n}\r\n\r\n//从pinia中取出规格数据\r\nconst selectedSpec = computed (() =>{\r\n\treturn specStore.specText\r\n})\r\nconst selCount=computed(()=>{\n\treturn specStore.count\n})\n\r\n\r\n//加入购物车\r\nconst addCart = async ()=>{\n\tif(selectedSpec.value){\n\t\ttry {\n\t\t\tconst res=await post(\"/cart/addCart\",{\n\t\t\t\tproduct_id:productInfo.value.id,\n\t\t\t\tname:productInfo.value.name,\n\t\t\t\tprice:productInfo.value.price,\n\t\t\t\tcount:selCount.value,\n\t\t\t\tspec:selectedSpec.value,\n\t\t\t\tmain_pic:productInfo.value.main_pic\n\t\t\t})\n\t\t\tuni.showToast({\n\t\t\t\ttitle:\"加购成功\",\n\t\t\t\ticon:\"success\"\n\t\t\t})\n\t\t\tspecStore.setSpec(\"\")\n\t\t\tspecStore.setCount(1)\n\t\t\thandleClose()\n\t\t} catch (error) {\n\t\t\t//TODO handle the exception\n\t\t\tuni.__f__('error','at packageA/product-detail/product-detail.vue:149',error)\n\t\t}\n\t}else{\n\t\tshowSpecPopup()\n\t}\n}\r\n\r\n//立即购买\r\nconst buyNow = ()=>{\r\n\t\r\n}\r\n\r\n//去首页\r\nconst goHome=()=>{\n\tuni.switchTab({\n\t\turl:\"/pages/index/index\"\n\t})\n}\r\n\r\n//去购物车\nconst goCart=()=>{\n\tconst token=uni.getStorageSync(\"token\");\n\tif(!token){\n\t\tuni.navigateTo({\n\t\t\turl:\"/pages/login/login\"\n\t\t})\n\t\treturn\n\t}\n\tuni.navigateTo({\n\t\turl:\"/pages/cart/cart\"\n\t})\n}\n</script>\n\n<style lang=\"scss\" scoped>\n\t.product-detail{\n\t\tmin-height: 100vh;\n\t\tbackground-color: #f5f5f5;\n\t\tpadding-bottom: 120rpx;\n\t\t.swiper{\n\t\t\twidth: 100%;\n\t\t\theight: 750rpx;\n\t\t\timage{\n\t\t\t\twidth: 100%;\n\t\t\t\theight:100% ;\n\t\t\t}\n\t\t}\n\t\t.product-info{\n\t\t\tbackground-color: #fff;\n\t\t\tpadding: 30rpx;\n\t\t\tmargin-bottom: 20rpx;\n\t\t\t.price-box{\n\t\t\t\tmargin-bottom: 20rpx;\n\t\t\t\t.price{\n\t\t\t\t\tcolor: #ff6b81;\n\t\t\t\t\tfont-size: 40rpx;\n\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\tmargin-right: 20rpx;\n\t\t\t\t}\n\t\t\t\t.original-price{\n\t\t\t\t\tcolor:#999;\n\t\t\t\t\tfont-size: 28rpx;\n\t\t\t\t\ttext-decoration: line-through;\n\t\t\t\t}\n\t\t\t}\n\t\t\t.title{\n\t\t\t\tfont-size: 32rpx;\n\t\t\t\tfont-weight: bold;\n\t\t\t\tcolor:#333;\n\t\t\t\tmargin-bottom: 16rpx;\n\t\t\t}\n\t\t\t.desc{\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tcolor: #666;\n\t\t\t\tline-height: 1.6;\n\t\t\t}\n\t\t}\n\t\t.spec-section{\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tbackground-color: #fff;\n\t\t\tpadding: 30rpx;\n\t\t\tmargin-bottom: 20rpx;\n\t\t\tjustify-content: space-between;\n\t\t\t.label{\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tcolor: #333;\n\t\t\t}\n\t\t\t.selected-spec{\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tcolor: #666;\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\ttext{\n\t\t\t\t\tmargin-right: 10rpx;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t.detail-section{\n\t\t\tbackground-color: #fff;\n\t\t\tpadding: 30rpx;\n\t\t\t.section-title{\n\t\t\t\tfont-size: 32rpx;\n\t\t\t\tfont-weight: bold;\n\t\t\t\tcolor: #333;\n\t\t\t\tmargin-bottom: 30rpx;\n\t\t\t}\n\t\t\t.detail-content{\n\t\t\t\tpadding: 20rpx;\n\t\t\t\t.detail-image{\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tmargin-bottom: 20rpx;\n\t\t\t\t\tborder-radius: 12rpx;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t.bottom-bar{\n\t\t\tposition: fixed;\n\t\t\tbottom: 0;\n\t\t\tleft: 0;\n\t\t\tright: 0;\n\t\t\theight: 60rpx;\n\t\t\tbackground-color: #fff;\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tpadding: 30rpx;\n\t\t\tbox-shadow: 0 -2rpx 10rpx rgba(0, 0, 0, 0.05);\n\t\t\t.left-btns{\n\t\t\t\tdisplay: flex;\n\t\t\t\tmargin-right: 30rpx;\n\t\t\t\t.icon-btn{\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tflex-direction: column;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tmargin-right: 30rpx;\n\t\t\t\t\ttext{\n\t\t\t\t\t\tfont-size: 24rpx;\n\t\t\t\t\t\tcolor: #666;\n\t\t\t\t\t\tmargin-top: 4rpx;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t.right-btns{\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex: 1;\n\t\t\t\t.cart-btn,.buy-btn{\n\t\t\t\t\tflex: 1;\n\t\t\t\t\theight: 80rpx;\n\t\t\t\t\tborder-radius: 40rpx;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tfont-size: 32rpx;\n\t\t\t\t\tfont-weight: bold;\n\t\t\t\t}\n\t\t\t\t.cart-btn{\n\t\t\t\t\tbackground-color: #fff8e6;\n\t\t\t\t\tcolor: #ffce2c;\n\t\t\t\t\tmargin-right: 20rpx;\n\t\t\t\t}\n\t\t\t\t.buy-btn{\n\t\t\t\t\tbackground-color: #ffce2c;\n\t\t\t\t\tcolor: #fff;\n\t\t\t\t}\n\t\t\t}\n\t\t}\t\n\t}\n</style>","import MiniProgramPage from 'D:/uni-app项目/liuliuzhua/packageA/product-detail/product-detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["useSpecStore","ref","onLoad","uni","get","computed","post"],"mappings":";;;;;;;;;;;;AAoEA,MAAA,mBAA6B,MAAA;;;;AAE7B,UAAM,YAAYA,WAAAA;AAkBZ,UAAA,cAAYC,kBAAmB,CAAA,CAAmB;AACxDC,kBAAA,OAAO,CAAC,YAAU;AACjB,kBAAY,QAAO,KAAK,MAAM,QAAQ,OAAO;AAC7CC,oBAAA,MAAI,MAAM,OAAM,oDAAmD,YAAY,OAAM,GAAG;AAC9E;AACV,gBAAU,QAAQ,EAAE;AACpB,gBAAU,SAAS,CAAC;AAAA,IAAA,CACpB;AAGK,UAAA,gBAAcF,kBAAoB,CAAA,CAAE;AAC1C,UAAM,YAAW,YAAU;AACtB,UAAA;AACG,cAAA,MAAQ,MAAMG,iBAAI,IAAA,eAAc,EAAC,IAAG,YAAY,MAAM,GAAA,CAAG;AAC/D,sBAAc,QAAM;AAAA,eAEZ,OAAO;AACXD,sBAAAA,MAAA,MAAM,SAAQ,qDAAoD,IAAI;AAAA,MAC3E;AAAA,IAAA;AAIK,UAAA,OAAOF,kBAAI,KAAK;AACtB,UAAM,gBAAgB,MAAK;AAC1B,WAAK,QAAQ;AAAA,IAAA;AAEd,UAAM,cAAc,MAAK;AACxB,WAAK,QAAQ;AAAA,IAAA;AAIR,UAAA,eAAeI,cAAAA,SAAU,MAAK;AACnC,aAAO,UAAU;AAAA,IAAA,CACjB;AACK,UAAA,WAASA,cAAAA,SAAS,MAAI;AAC3B,aAAO,UAAU;AAAA,IAAA,CACjB;AAID,UAAM,UAAU,YAAU;AACzB,UAAG,aAAa,OAAM;AACjB,YAAA;AACG,gBAAA,MAAI,MAAMC,iBAAA,KAAK,iBAAgB;AAAA,YACpC,YAAW,YAAY,MAAM;AAAA,YAC7B,MAAK,YAAY,MAAM;AAAA,YACvB,OAAM,YAAY,MAAM;AAAA,YACxB,OAAM,SAAS;AAAA,YACf,MAAK,aAAa;AAAA,YAClB,UAAS,YAAY,MAAM;AAAA,UAAA,CAC3B;AACDH,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAM;AAAA,YACN,MAAK;AAAA,UAAA,CACL;AACD,oBAAU,QAAQ,EAAE;AACpB,oBAAU,SAAS,CAAC;AACR;iBACJ,OAAO;AAEXA,wBAAAA,MAAA,MAAM,SAAQ,qDAAoD,KAAK;AAAA,QAC5E;AAAA,MAAA,OACI;AACU;MACf;AAAA,IAAA;AAID,UAAM,SAAS,MAAI;AAAA,IAAA;AAKnB,UAAM,SAAO,MAAI;AAChBA,oBAAAA,MAAI,UAAU;AAAA,QACb,KAAI;AAAA,MAAA,CACJ;AAAA,IAAA;AAIF,UAAM,SAAO,MAAI;AACV,YAAA,QAAMA,cAAAA,MAAI,eAAe,OAAO;AACtC,UAAG,CAAC,OAAM;AACTA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAI;AAAA,QAAA,CACJ;AACD;AAAA,MACD;AACAA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAI;AAAA,MAAA,CACJ;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjLF,GAAG,WAAW,eAAe;"}