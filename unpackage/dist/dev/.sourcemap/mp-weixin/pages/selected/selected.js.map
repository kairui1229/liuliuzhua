{"version":3,"file":"selected.js","sources":["pages/selected/selected.vue","../../Hbuilder/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc2VsZWN0ZWQvc2VsZWN0ZWQudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<view class=\"header\">\r\n\t\t\t<view class=\"nav-content\">\r\n\t\t\t\t<uni-search-bar\r\n\t\t\t\t radius=\"100\" \r\n\t\t\t\t placeholder=\"猫粮狗粮、宠物零食\" \r\n\t\t\t\t clearButton=\"none\" \r\n\t\t\t\t cancelButton=\"none\"\r\n\t\t\t\t style=\"width: 100%\"\r\n\t\t\t\t>\r\n\t\t\t\t</uni-search-bar>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"content\">\r\n\t\t\t<view class=\"category-section\">\r\n\t\t\t\t<!-- 左侧分类 -->\r\n\t\t\t\t<scroll-view class=\"category-left\" scroll-y>\r\n\t\t\t\t  <view \r\n\t\t\t\t  v-for=\"(item,index) in categories\" \r\n\t\t\t\t  :key=\"item.id\" \r\n\t\t\t\t  class=\"category-item\"\r\n\t\t\t\t  :class=\"{active:currentCategory === index}\"\r\n\t\t\t\t  @click=\"switchCategory(index,item.id)\"\r\n\t\t\t\t  >\r\n\t\t\t\t  {{item.category_name}}\r\n\t\t\t\t  </view>\r\n\t\t\t\t</scroll-view>\r\n\t\t\t\t\r\n\t\t\t\t<!-- 右侧商品 -->\r\n\t\t\t\t<scroll-view class=\"category-right\" scroll-y>\r\n\t\t\t\t\t<view class=\"category-title\">{{categories[currentCategory].category_name}}</view>\r\n\t\t\t\t\t<view class=\"product-list\">\r\n\t\t\t\t\t\t<view class=\"product-item\" v-for=\"item in products\" :key=\"item.id\">\r\n\t\t\t\t\t\t\t<image \r\n\t\t\t\t\t\t\t:src=\"item.main_pic\" \r\n\t\t\t\t\t\t\tmode=\"aspectFill\" \r\n\t\t\t\t\t\t\tclass=\"product-image\" \r\n\t\t\t\t\t\t\t@click=goProductDetail(item)\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t</image>\r\n\t\t\t\t\t\t\t<view class=\"product-info\">\r\n\t\t\t\t\t\t\t\t<text class=\"product-name\">{{item.name}}</text>\r\n\t\t\t\t\t\t\t\t<view class=\"product-row\">\r\n\t\t\t\t\t\t\t\t\t<text class=\"product-price\">¥{{item.price}}</text>\r\n\t\t\t\t\t\t\t\t\t<view class=\"add-cart\" @click=\"addCart(item)\">\r\n\t\t\t\t\t\t\t\t\t\t<up-icon name=\"shopping-cart\" color=\"#fff\" size=\"18\"></up-icon>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</scroll-view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n\t\r\n\t<view class=\"float-cart\" @click=goCart>\r\n\t\t<up-icon name=\"shopping-cart\" color=\"#ffce2c\" size=\"80rpx\"></up-icon>\r\n\t\t<view class=\"cart-badge\" v-if=\"cartCount > 0\">\r\n\t\t\t{{cartCount}}\r\n\t\t</view>\r\n\t</view>\r\n\t\r\n\t<ProductsSpecPopup :show=\"show\" :product=\"selProduct\" @close=\"handleClose\" :show-ok=\"false\"></ProductsSpecPopup>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport {onLoad,onReachBottom,onShow} from \"@dcloudio/uni-app\"\r\nimport {ref,computed} from \"vue\"\r\nimport {get} from \"@/utils/http\"\r\nimport ProductsSpecPopup from \"../../components/products-spec-popup/products-spec-popup.vue\"\r\n\r\nonLoad(() =>{\r\n\tgetCategories()\r\n})\r\n\r\nonShow(() =>{\r\n\tgetCartCount()\r\n})\r\n\r\n//获取左侧菜单分类\r\nconst categories:any = ref([])\r\nconst currentPage= ref(1)\r\nconst getCategories = async () =>{\r\n\tconst data:any = await get(\"/sel/tag\")\r\n\tcategories.value = data.tag\r\n\tgetProducts(currentPage.value,categories.value[0].id)\r\n\t//uni.__f__('log','at pages/selected/selected.vue:89',categories.value,123)\r\n}\r\n\r\n//设置高亮效果\r\nconst currentCategory = ref(0)\r\nconst switchCategory = (index:number,category_id:number) =>{\r\n\tcurrentCategory.value = index\r\n\tproducts.value = []\r\n\tgetProducts(1,category_id)\r\n}\r\n\r\n//获取右侧商品列表\r\nconst products = ref([])\r\nconst totalPages = ref(0)\r\nconst getProducts = async (page:number,category_id:number) =>{\r\n\tconst data:any = await get(\"/sel/products\",{page,category_id})\r\n\tuni.__f__('log','at pages/selected/selected.vue:105',\"商品数据\",data)\r\n\tif(page === 1){\r\n\t\tproducts.value = data.list\r\n\t}else{\r\n\t\tproducts.value = [...products.value,...data.list]\r\n\t}\r\n\ttotalPages.value = data.pagination.totalPages\r\n\tcurrentPage.value = page\r\n}\r\n\r\nonReachBottom(() => {\r\n\tif(currentPage.value < totalPages.value){\r\n\t\tgetProducts(currentPage.value+1,categories.value[currentCategory.value].id)\r\n\t}\r\n})\r\n\r\n//购物车\r\nconst cartCount = ref(0)\r\nconst getCartCount = async () =>{\r\n\tconst data:any = await get(\"/cart/list\")\r\n\tuni.__f__('log','at pages/selected/selected.vue:125',\"购物车数据\",data)\r\n\tcartCount.value = data.length\r\n}\r\nconst goCart = () =>{\r\n\t//先判断用户是否登录，如果没有登录就要先跳到登录页面\r\n\tconst token = uni.getStorageSync(\"token\")\r\n\tif(!token){\r\n\t\tuni.navigateTo({\r\n\t\t\turl:\"/pages/login/login\"\r\n\t\t})\r\n\t\treturn\r\n\t}\r\n\tuni.navigateTo({\r\n\t\turl:\"/pages/cart/cart\"\r\n\t})\r\n}\r\n\r\n//规格弹窗\r\nconst show = ref(false)\r\nconst selProduct = ref({})\r\nconst addCart = (product:any) => {\r\n\tshow.value = true\r\n\tselProduct.value = product\r\n}\r\n\r\nconst handleClose = () =>{\r\n\tshow.value = false\r\n\tgetCartCount()\r\n}\r\n\r\n//跳转到详情页\r\nconst goProductDetail = (product:any) =>{\r\n\tuni.navigateTo({\r\n\t\turl:`/packageA/product-detail/product-detail?product=${JSON.stringify(product)}`\r\n\t})\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.container{\r\n\tbackground-color: #f7f7f7;\r\n\t.header{\r\n\t\tbackground-color: $uni-color-primary;\r\n\t\twidth: 100%;\r\n\t\t.nav-content{\r\n\t\t\theight: 88rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tpadding: 20rpx 50rpx;\r\n\t\t}\r\n\t}\r\n\t.content{\r\n\t\t.category-section{\r\n\t\t\tdisplay: flex;\r\n\t\t\tbackground-color: #fff;\r\n\t\t\tborder-radius: 16rpx;\r\n\t\t\theight: calc(100vh - 150rpx);\r\n\t\t\t.category-left{\r\n\t\t\t\twidth: 180rpx;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tbackground-color: #f7f7f7;\r\n\t\t\t\t.category-item{\r\n\t\t\t\t\tposition: relative;\r\n\t\t\t\t\theight: 100rpx;\r\n\t\t\t\t\tline-height: 100rpx;\r\n\t\t\t\t\ttext-align: center;\r\n\t\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\t\tcolor: $uni-text-color;\r\n\t\t\t\t\tborder-bottom: 1px solid #eee;\r\n\t\t\t\t\t&.active{\r\n\t\t\t\t\t\tbackground-color: #fff;\r\n\t\t\t\t\t\tcolor:$uni-color-primary;\r\n\t\t\t\t\t\tfont-weight: bold;\r\n\t\t\t\t\t\t&::before{\r\n\t\t\t\t\t\t\tcontent: \"\";\r\n\t\t\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\t\t\twidth: 6rpx;\r\n\t\t\t\t\t\t\theight: 30rpx;\r\n\t\t\t\t\t\t\tleft: 0;\r\n\t\t\t\t\t\t\ttop: 50%;\r\n\t\t\t\t\t\t\ttransform: translateY(-50%);\r\n\t\t\t\t\t\t\tbackground-color: $uni-color-primary;\r\n\t\t\t\t\t\t\tborder-radius: 0 4rpx 4rpx 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t.category-right{\r\n\t\t\t\tflex:1;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tpadding: 20rpx;\r\n\t\t\t\t.category-title{\r\n\t\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\t\tfont-weight: bold;\r\n\t\t\t\t\tmargin-bottom: 20rpx;\r\n\t\t\t\t\tpadding:0 10rpx;\r\n\t\t\t\t}\r\n\t\t\t\t.product-list{\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\t\t.product-item{\r\n\t\t\t\t\t\twidth: calc(50% - 20rpx);\r\n\t\t\t\t\t\tmargin: 10rpx;\r\n\t\t\t\t\t\tpadding: 10rpx;\r\n\t\t\t\t\t\tbox-sizing: border-box;\r\n\t\t\t\t\t\tborder-radius: 12rpx;\r\n\t\t\t\t\t\toverflow: hidden;\r\n\t\t\t\t\t\tbox-shadow: 0 2rpx 12rpx rgba(0, 0, 0,0.2);\r\n\t\t\t\t\t\t.product-image{\r\n\t\t\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\t\t\theight: 200rpx;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t.product-info{\r\n\t\t\t\t\t\t\tpadding: 16rpx;\r\n\t\t\t\t\t\t\t.product-name{\r\n\t\t\t\t\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\t\t\t\t\tcolor: #333;\r\n\t\t\t\t\t\t\t\tdisplay: block;\r\n\t\t\t\t\t\t\t\tmargin-bottom: 8rpx;\r\n\t\t\t\t\t\t\t\twhite-space: nowrap;\r\n\t\t\t\t\t\t\t\toverflow: hidden;\r\n\t\t\t\t\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\t\t\t\tline-height: 1.4;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t.product-row{\r\n\t\t\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\t\t\tjustify-content: space-between;\r\n\t\t\t\t\t\t\t\talign-items: center;\r\n\t\t\t\t\t\t\t\t.product-price{\r\n\t\t\t\t\t\t\t\t\tfont-size: 26rpx;\r\n\t\t\t\t\t\t\t\t\tcolor:$uni-color-primary;\r\n\t\t\t\t\t\t\t\t\tfont-weight: bold;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t.add-cart{\r\n\t\t\t\t\t\t\t\t\twidth: 48rpx;\r\n\t\t\t\t\t\t\t\t\theight: 48rpx;\r\n\t\t\t\t\t\t\t\t\tbackground-color: $uni-color-primary;\r\n\t\t\t\t\t\t\t\t\tborder-radius: 50%;\r\n\t\t\t\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\t\t\t\talign-items: center;\r\n\t\t\t\t\t\t\t\t\tjustify-content: center;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n.float-cart{\r\n\tposition: fixed;\r\n\tright:30rpx;\r\n\tbottom: 100rpx;\r\n\twidth: 100rpx;\r\n\theight: 100rpx;\r\n\tborder-radius: 50%;\r\n\tbackground-color: #fff;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tbox-shadow: 0 4rpx 16rpx rgba(0, 0, 0,0.2);\r\n\tz-index: 999;\r\n\t.cart-badge{\r\n\t\tposition: absolute;\r\n\t\ttop:-6rpx;\r\n\t\tright: -6rpx;\r\n\t\tbackground-color: #ff4d4f;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 24rpx;\r\n\t\twidth: 36rpx;\r\n\t\theight: 36rpx;\r\n\t\tline-height: 36rpx;\r\n\t\tborder-radius: 50%;\r\n\t\ttext-align: center;\r\n\t\tpadding: 6rpx;\r\n\t}\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/uni-app项目/liuliuzhua/pages/selected/selected.vue'\nwx.createPage(MiniProgramPage)"],"names":["onLoad","onShow","ref","get","uni","onReachBottom"],"mappings":";;;;;;;;;;;;;AAuEA,MAAA,oBAA8B,MAAA;;;;AAE9BA,kBAAAA,OAAO,MAAK;AACG;IAAA,CACd;AAEDC,kBAAAA,OAAO,MAAK;AACE;IAAA,CACb;AAGK,UAAA,aAAiBC,kBAAI,CAAA,CAAE;AACvB,UAAA,cAAaA,kBAAI,CAAC;AACxB,UAAM,gBAAgB,YAAW;AAC1B,YAAA,OAAW,MAAMC,qBAAI,UAAU;AACrC,iBAAW,QAAQ,KAAK;AACxB,kBAAY,YAAY,OAAM,WAAW,MAAM,CAAC,EAAE,EAAE;AAAA,IAAA;AAK/C,UAAA,kBAAkBD,kBAAI,CAAC;AACvB,UAAA,iBAAiB,CAAC,OAAa,gBAAsB;AAC1D,sBAAgB,QAAQ;AACxB,eAAS,QAAQ;AACjB,kBAAY,GAAE,WAAW;AAAA,IAAA;AAIpB,UAAA,WAAWA,kBAAI,CAAA,CAAE;AACjB,UAAA,aAAaA,kBAAI,CAAC;AAClB,UAAA,cAAc,OAAO,MAAY,gBAAsB;AAC5D,YAAM,OAAW,MAAMC,qBAAI,iBAAgB,EAAC,MAAK,aAAY;AAC7DC,oBAAA,MAAI,MAAM,OAAM,sCAAqC,QAAO,IAAI;AAChE,UAAG,SAAS,GAAE;AACb,iBAAS,QAAQ,KAAK;AAAA,MAAA,OAClB;AACJ,iBAAS,QAAQ,CAAC,GAAG,SAAS,OAAM,GAAG,KAAK,IAAI;AAAA,MACjD;AACW,iBAAA,QAAQ,KAAK,WAAW;AACnC,kBAAY,QAAQ;AAAA,IAAA;AAGrBC,kBAAAA,cAAc,MAAM;AAChB,UAAA,YAAY,QAAQ,WAAW,OAAM;AAC3B,oBAAA,YAAY,QAAM,GAAE,WAAW,MAAM,gBAAgB,KAAK,EAAE,EAAE;AAAA,MAC3E;AAAA,IAAA,CACA;AAGK,UAAA,YAAYH,kBAAI,CAAC;AACvB,UAAM,eAAe,YAAW;AACzB,YAAA,OAAW,MAAMC,qBAAI,YAAY;AACvCC,oBAAA,MAAI,MAAM,OAAM,sCAAqC,SAAQ,IAAI;AACjE,gBAAU,QAAQ,KAAK;AAAA,IAAA;AAExB,UAAM,SAAS,MAAK;AAEb,YAAA,QAAQA,cAAAA,MAAI,eAAe,OAAO;AACxC,UAAG,CAAC,OAAM;AACTA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAI;AAAA,QAAA,CACJ;AACD;AAAA,MACD;AACAA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAI;AAAA,MAAA,CACJ;AAAA,IAAA;AAII,UAAA,OAAOF,kBAAI,KAAK;AAChB,UAAA,aAAaA,kBAAI,CAAA,CAAE;AACnB,UAAA,UAAU,CAAC,YAAgB;AAChC,WAAK,QAAQ;AACb,iBAAW,QAAQ;AAAA,IAAA;AAGpB,UAAM,cAAc,MAAK;AACxB,WAAK,QAAQ;AACA;IAAA;AAIR,UAAA,kBAAkB,CAAC,YAAe;AACvCE,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAI,mDAAmD,KAAK,UAAU,OAAO,CAAC;AAAA,MAAA,CAC9E;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7JF,GAAG,WAAW,eAAe;"}