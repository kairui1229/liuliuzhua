{"version":3,"file":"cart.js","sources":["pages/cart/cart.vue","../../Hbuilder/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2FydC9jYXJ0LnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"cart-container\">\n\t\t<view class=\"cart-list\" v-if=\"cartList.length>0\">\n\t\t\t<view class=\"cart-item\" v-for=\"item in cartList\" :key=\"item.cart_id\">\n\t\t\t\t<view class=\"checkbox\">\n\t\t\t\t\t<up-checkbox usedAlone v-model:checked=\"item.selected\"></up-checkbox>\n\t\t\t\t</view>\n\t\t\t\t<image class=\"product-img\" :src=\"item.main_pic\" mode=\"aspectFill\"></image>\n\t\t\t\t<view class=\"product-info\">\n\t\t\t\t\t<view class=\"product-name\">{{item.name}}</view>\n\t\t\t\t\t<view class=\"product-spec\">{{item.spec}}</view>\n\t\t\t\t\t<view class=\"price-quantity\">\n\t\t\t\t\t\t<view class=\"price\">￥{{item.price}}</view>\n\t\t\t\t\t\t<view class=\"quantity-control\">\n\t\t\t\t\t\t\t<text class=\"quantity-label\">数量：</text>\n\t\t\t\t\t\t\t<view class=\"quantity-text\">{{item.count}}</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"delete-btn\" @click=\"deleteItem(item.cart_id)\">\n\t\t\t\t\t<up-icon name=\"trash\" size=\"20\" color=\"#999\"></up-icon>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\r\n\t\t\n\t\t<!--空购物车-->\n\t\t<view class=\"empty-cart\" v-else>\n\t\t\t<view class=\"empty-text\">购物车空空如也~</view>\n\t\t\t<view class=\"go-shopping\">去逛逛!</view>\n\t\t</view>\r\n\t\t\n\t\t<!--底部结算栏-->\n\t\t<view class=\"settlement-bar\">\n\t\t\t<view class=\"select-all\">\n\t\t\t\t<up-checkbox usedAlone v-model:checked=\"allChecked\" @change=\"toggleAllChecked\"></up-checkbox>\n\t\t\t</view>\n\t\t\t<view class=\"total-info\">\n\t\t\t\t<view class=\"total-price\">\n\t\t\t\t\t合计：<text class=\"price\">￥{{totalPrice}}</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"total-desc\">不含运费</view>\n\t\t\t</view>\n\n\t\t\t<view class=\"settle-btn\" :class=\"{active:selectedCount>0}\" @click=\"goOrder\">结算({{selectedCount}})</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, watch} from 'vue'\nimport { get,post } from '../../utils/http'\nimport { onLoad } from \"@dcloudio/uni-app\"\r\n\r\nonLoad(() => {\n\tgetCart()\n})\r\n\r\n//购物车数据\nconst cartList = ref([])\nconst getCart = async () => {\n\ttry {\n\t\tconst data : any = await get(\"/cart/list\")\n\t\tuni.__f__('log','at pages/cart/cart.vue:63',\"购物车数据\", data)\n\t\tcartList.value = data.map(item => ({\n\t\t\t...item,\n\t\t\tselected: false\n\t\t}))\n\t} catch (error) {\n\t\t//TODO handle the exception\n\t\tuni.__f__('error','at pages/cart/cart.vue:70',\"获取失败\")\n\t}\n}\r\n\r\n//计算总价\r\nconst totalPrice = computed(()=>{\r\n\tlet total = 0\r\n\tfor(const item of cartList.value){\r\n\t\tif(item.selected){\r\n\t\t\ttotal += Number(item.price)\r\n\t\t}\r\n\t}\r\n\treturn total.toFixed(2)\r\n})\r\n\r\n//计算选中商品数量\r\nconst selectedCount = computed(()=>{\r\n\treturn cartList.value.filter(item => item.selected).length\r\n})\r\n\r\n//全选功能\r\nconst allChecked = ref(false)\r\nwatch(cartList,()=>{\r\n\t//cartList数组，里面嵌套对象 默认浅层监听\r\n\t//如果购物车数据为空的话，不做判断直接为false\r\n\tif(cartList.value.length===0){\r\n\t\tallChecked.value=false;\r\n\t\treturn\r\n\t}\r\n\tallChecked.value = cartList.value.length === selectedCount.value\r\n},{deep:true})\r\n\r\nconst toggleAllChecked = () =>{\r\n\tcartList.value.forEach(item=>{\r\n\t\titem.selected = !allChecked.value\r\n\t})\r\n}\r\n\r\n//删除购物车数据\nconst deleteItem=(cart_id:number)=>{\n\tuni.showModal({\n\t\ttitle:\"提示\",\n\t\tcontent:\"确定要删除此商品吗?\",\n\t\tsuccess:async (res) =>{\n\t\t\tif(res.confirm){\n\t\t\t\ttry {\n\t\t\t\t\tawait post(\"/cart/deleteCart\",{cart_id})\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle:\"删除成功\",\n\t\t\t\t\t\ticon:\"success\"\n\t\t\t\t\t})\n\t\t\t\t\tgetCart();\n\t\t\t\t} catch (error) {\n\t\t\t\t\tuni.__f__('error','at pages/cart/cart.vue:123',\"删除商品失败\")\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t})\n}\r\n\r\nconst goOrder = () =>{\r\n\tif(selectedCount.value){\r\n\t\tuni.navigateTo({\r\n\t\t\turl:\"/packageB/order/order\"\r\n\t\t})\r\n\t}\r\n}\n</script>\n\n<style lang=\"scss\" scoped>\n\t.cart-container {\n\t\tbackground-color: #f8f8f8;\n\t\tpadding-bottom: 100rpx;\n\t\tmin-height: 100vh;\n\n\t\t.cart-list {\n\t\t\tpadding: 20rpx;\n\n\t\t\t.cart-item {\n\t\t\t\tbackground-color: #fff;\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tpadding: 20rpx;\n\t\t\t\tmargin-bottom: 20rpx;\n\t\t\t\tborder-radius: 12rpx;\n\n\t\t\t\t.checkbox {\n\t\t\t\t\tmargin-right: 20rpx;\n\t\t\t\t}\n\n\t\t\t\t.product-img {\n\t\t\t\t\twidth: 160rpx;\n\t\t\t\t\theight: 160rpx;\n\t\t\t\t\tborder-radius: 8rpx;\n\t\t\t\t\tmargin-right: 20rpx;\n\t\t\t\t}\n\n\t\t\t\t.product-info {\n\t\t\t\t\tflex: 1;\n\n\t\t\t\t\t.product-name {\n\t\t\t\t\t\tfont-size: 28rpx;\n\t\t\t\t\t\tcolor: #333;\n\t\t\t\t\t\tmargin-bottom: 10rpx;\n\t\t\t\t\t}\n\n\t\t\t\t\t.product-spec {\n\t\t\t\t\t\tfont-size: 24rpx;\n\t\t\t\t\t\tcolor: #999;\n\t\t\t\t\t\tmargin-bottom: 20rpx;\n\t\t\t\t\t}\n\n\t\t\t\t\t.price-quantity {\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tjustify-content: space-between;\n\t\t\t\t\t\talign-items: center;\n\n\t\t\t\t\t\t.price {\n\t\t\t\t\t\t\tcolor: #ff4d4f;\n\t\t\t\t\t\t\tfont-size: 32rpx;\n\t\t\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t.quantity-control {\n\t\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\t\talign-items: center;\n\n\t\t\t\t\t\t\t.quantity-label {\n\t\t\t\t\t\t\t\tfont-size: 26rpx;\n\t\t\t\t\t\t\t\tcolor: #999;\n\t\t\t\t\t\t\t\tmargin-right: 10rpx;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t.quantity-text {\n\t\t\t\t\t\t\t\tfont-size: 28rpx;\n\t\t\t\t\t\t\t\tcolor: #333;\n\t\t\t\t\t\t\t\tbackground-color: #f5f5f5;\n\t\t\t\t\t\t\t\tpadding: 4rpx 20rpx;\n\t\t\t\t\t\t\t\tborder-radius: 6rpx;\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.delete-btn {\n\t\t\t\t\tpadding: 20rpx;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t.empty-cart {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\talign-items: center;\n\t\t\tpadding-top: 200rpx;\n\n\t\t\t.empty-text {\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tcolor: #999;\n\t\t\t\tmargin-bottom: 40rpx;\n\t\t\t}\n\n\t\t\t.go-shopping {\n\t\t\t\twidth: 240rpx;\n\t\t\t\theight: 80rpx;\n\t\t\t\tbackground-color: #ffce2c;\n\t\t\t\tcolor: #fff;\n\t\t\t\tborder-radius: 40rpx;\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\ttext-align: center;\n\t\t\t\tline-height: 80rpx;\n\n\t\t\t}\n\t\t}\n\n\t\t.settlement-bar {\n\t\t\tposition: fixed;\n\t\t\tbottom: 0;\n\t\t\tleft: 0;\n\t\t\tright: 0;\n\t\t\theight: 100rpx;\n\t\t\tbackground-color: #fff;\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tpadding: 0 20rpx;\n\t\t\tbox-shadow: 0 -2rpx 10rpx rgba(0, 0, 0, 0.05);\n\n\t\t\t.select-all {\n\t\t\t\tmargin-right: 20rpx;\n\t\t\t}\n\n\t\t\t.total-info {\n\t\t\t\tflex: 1;\n\n\t\t\t\t.total-price {\n\t\t\t\t\tfont-size: 28rpx;\n\t\t\t\t\tcolor: #333;\n\n\t\t\t\t\t.price {\n\t\t\t\t\t\tcolor: #ff4d4f;\n\t\t\t\t\t\tfont-size: 36rpx;\n\t\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.total-desc {\n\t\t\t\t\tfont-size: 24rpx;\n\t\t\t\t\tcolor: #999;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t.settle-btn {\n\t\t\t\twidth: 200rpx;\n\t\t\t\theight: 80rpx;\n\t\t\t\tbackground-color: #ddd;\n\t\t\t\tcolor: #fff;\n\t\t\t\tborder-radius: 40rpx;\n\t\t\t\ttext-align: center;\n\t\t\t\tline-height: 80rpx;\n\t\t\t\tfont-size: 28rpx;\n\n\t\t\t\t&.active {\n\n\t\t\t\t\tbackground-color: #ffce2c !important;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n</style>\n","import MiniProgramPage from 'D:/uni-app项目/liuliuzhua/pages/cart/cart.vue'\nwx.createPage(MiniProgramPage)"],"names":["onLoad","ref","get","uni","computed","watch","post"],"mappings":";;;;;;;;;;;;;;;;AAqDAA,kBAAAA,OAAO,MAAM;AACJ;IAAA,CACR;AAGK,UAAA,WAAWC,kBAAI,CAAA,CAAE;AACvB,UAAM,UAAU,YAAY;AACvB,UAAA;AACG,cAAA,OAAa,MAAMC,qBAAI,YAAY;AACzCC,sBAAA,MAAI,MAAM,OAAM,6BAA4B,SAAS,IAAI;AAChD,iBAAA,QAAQ,KAAK,IAAI,CAAS,UAAA;AAAA,UAClC,GAAG;AAAA,UACH,UAAU;AAAA,QACT,EAAA;AAAA,eACM,OAAO;AAEXA,sBAAAA,MAAA,MAAM,SAAQ,6BAA4B,MAAM;AAAA,MACrD;AAAA,IAAA;AAIK,UAAA,aAAaC,cAAAA,SAAS,MAAI;AAC/B,UAAI,QAAQ;AACF,iBAAA,QAAQ,SAAS,OAAM;AAChC,YAAG,KAAK,UAAS;AACP,mBAAA,OAAO,KAAK,KAAK;AAAA,QAC3B;AAAA,MACD;AACO,aAAA,MAAM,QAAQ,CAAC;AAAA,IAAA,CACtB;AAGK,UAAA,gBAAgBA,cAAAA,SAAS,MAAI;AAClC,aAAO,SAAS,MAAM,OAAO,CAAQ,SAAA,KAAK,QAAQ,EAAE;AAAA,IAAA,CACpD;AAGK,UAAA,aAAaH,kBAAI,KAAK;AAC5BI,kBAAA,MAAM,UAAS,MAAI;AAGf,UAAA,SAAS,MAAM,WAAS,GAAE;AAC5B,mBAAW,QAAM;AACjB;AAAA,MACD;AACA,iBAAW,QAAQ,SAAS,MAAM,WAAW,cAAc;AAAA,IAAA,GAC1D,EAAC,MAAK,KAAA,CAAK;AAEb,UAAM,mBAAmB,MAAK;AACpB,eAAA,MAAM,QAAQ,CAAM,SAAA;AACvB,aAAA,WAAW,CAAC,WAAW;AAAA,MAAA,CAC5B;AAAA,IAAA;AAII,UAAA,aAAW,CAAC,YAAiB;AAClCF,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAM;AAAA,QACN,SAAQ;AAAA,QACR,SAAQ,OAAO,QAAO;AACrB,cAAG,IAAI,SAAQ;AACV,gBAAA;AACH,oBAAMG,sBAAK,oBAAmB,EAAC,QAAQ,CAAA;AACvCH,4BAAAA,MAAI,UAAU;AAAA,gBACb,OAAM;AAAA,gBACN,MAAK;AAAA,cAAA,CACL;AACO;qBACA,OAAO;AACXA,4BAAAA,MAAA,MAAM,SAAQ,8BAA6B,QAAQ;AAAA,YACxD;AAAA,UACD;AAAA,QACD;AAAA,MAAA,CACA;AAAA,IAAA;AAGF,UAAM,UAAU,MAAK;AACpB,UAAG,cAAc,OAAM;AACtBA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAI;AAAA,QAAA,CACJ;AAAA,MACF;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrID,GAAG,WAAW,eAAe;"}